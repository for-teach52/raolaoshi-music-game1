<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>È•∂ËÄÅÂ∏àÁöÑÈü≥‰πêÂ∞èÊ∏∏Êàè üéπ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Comic Sans MS", "ÂπºÂúÜ", "ÂæÆËΩØÈõÖÈªë", sans-serif;
        }

        body {
            background-color: #f8f9fa;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ff99cc' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 0 30px rgba(0,0,0,0.1);
            padding: 30px;
            max-width: 800px;
            width: 100%;
            position: relative;
            overflow: hidden;
        }

        .game-container::before {
            content: "";
            position: absolute;
            top: -50px;
            right: -50px;
            width: 200px;
            height: 200px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23ff66cc'%3E%3Cpath d='M18 9v4H6V9H4v6h16V9h-2zm-2 2h-4v2h4v-2zM4 4h16v2H4V4zm0 14h12v2H4v-2z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            opacity: 0.1;
            transform: rotate(15deg);
        }

        .game-container::after {
            content: "";
            position: absolute;
            bottom: -50px;
            left: -50px;
            width: 200px;
            height: 200px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%236699ff'%3E%3Cpath d='M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6zm-2 16c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            opacity: 0.1;
            transform: rotate(-15deg);
        }

        .game-title {
            text-align: center;
            font-size: 2.5rem;
            color: #ff66cc;
            text-shadow: 2px 2px 0 #ffff99;
            margin-bottom: 20px;
            letter-spacing: 2px;
        }

        button {
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            font-weight: bold;
        }

        button:hover {
            transform: scale(1.05);
        }

        .start-btn {
            background: linear-gradient(45deg, #66ccff, #ff66cc);
            color: white;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.5rem;
            margin: 20px auto;
            display: block;
            box-shadow: 0 5px 15px rgba(102, 204, 255, 0.4);
        }

        .start-btn:active {
            transform: scale(0.98);
        }

        .question-area {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background-color: #f0f8ff;
            border-radius: 15px;
            border: 3px dashed #66ccff;
        }

        .question-text {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 20px;
        }

        .audio-btn {
            background: linear-gradient(45deg, #ffff99, #ffcc66);
            color: #333;
            padding: 12px 30px;
            border-radius: 50px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 10px rgba(255, 204, 102, 0.3);
        }

        .audio-icon {
            font-size: 1.2rem;
        }

        .options-area {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 30px 0;
        }

        .option-btn {
            background: linear-gradient(45deg, #ff99cc, #ff66cc);
            color: white;
            padding: 20px 15px;
            border-radius: 15px;
            border-bottom: 5px solid #cc3399;
            text-align: center;
        }

        .option-btn.correct {
            background: linear-gradient(45deg, #99ff99, #66cc66);
            border-bottom: 5px solid #339933;
        }

        .option-btn.wrong {
            background: linear-gradient(45deg, #ff9999, #ff6666);
            border-bottom: 5px solid #cc3333;
        }

        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        .score-board {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #fff8e6;
            padding: 15px 25px;
            border-radius: 50px;
            margin: 20px 0;
            border: 2px solid #ffcc66;
        }

        .score-text, .question-count {
            font-size: 1.2rem;
            color: #333;
            font-weight: bold;
        }

        .score-value {
            color: #ff6600;
            font-size: 1.5rem;
        }

        .instrument-info {
            background-color: #f9f0ff;
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid #cc99ff;
            margin: 20px 0;
        }

        .instrument-title {
            font-size: 1.2rem;
            color: #9933cc;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .instrument-desc {
            color: #555;
            line-height: 1.6;
        }

        .feedback-area {
            text-align: center;
            margin: 20px 0;
            min-height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .feedback-text {
            font-size: 1.5rem;
            font-weight: bold;
            padding: 10px 30px;
            border-radius: 50px;
            display: inline-block;
        }

        .feedback-correct {
            background-color: #e6ffe6;
            color: #339933;
            border: 2px solid #66cc66;
        }

        .feedback-wrong {
            background-color: #e6ffe6;
            color: #cc3333;
            border: 2px solid #ff6666;
        }

        .result-area {
            text-align: center;
            padding: 30px;
            background: linear-gradient(45deg, #66ccff, #ff99cc);
            border-radius: 20px;
            color: white;
            margin: 20px 0;
            box-shadow: 0 10px 20px rgba(102, 204, 255, 0.3);
        }

        .result-title {
            font-size: 1.8rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }

        .result-score {
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .restart-btn {
            background-color: white;
            color: #ff66cc;
            padding: 12px 40px;
            border-radius: 50px;
            box-shadow: 0 5px 15px rgba(255, 255, 255, 0.3);
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .game-container {
                padding: 20px 15px;
            }

            .game-title {
                font-size: 2rem;
            }

            .options-area {
                grid-template-columns: 1fr;
            }

            .score-board {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }

            .question-text {
                font-size: 1.1rem;
            }
        }

        @media (max-width: 480px) {
            .game-title {
                font-size: 1.8rem;
            }

            .option-btn {
                padding: 15px 10px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="game-title">üéµ È•∂ËÄÅÂ∏àÁöÑÈü≥‰πêÂ∞èÊ∏∏Êàè üéπ</h1>
        
        <button class="start-btn" id="startBtn">ÂºÄÂßãÊ∏∏Êàè üéÆ</button>
        
        <div class="game-main hidden" id="gameMain">
            <div class="score-board">
                <div class="score-text">ÂæóÂàÜ: <span class="score-value" id="score">0</span> ÂàÜ</div>
                <div class="question-count">Á¨¨ <span id="currentQuestion">1</span>/10 È¢ò</div>
            </div>
            
            <div class="question-area">
                <p class="question-text">ËøôÊÆµÈü≥‰πêÊòØÁî±Âì™Áßç‰πêÂô®ÊºîÂ•èÁöÑÔºü</p>
                <button class="audio-btn" id="audioBtn">
                    <span class="audio-icon">üîä</span> Êí≠ÊîæÈü≥‰πê
                </button>
            </div>
            
            <div class="options-area" id="optionsArea"></div>
            
            <div class="instrument-info" id="instrumentInfo">
                <h3 class="instrument-title" id="instrumentTitle">‰πêÂô®Â∞èÁü•ËØÜ</h3>
                <p class="instrument-desc" id="instrumentDesc">ÂõûÁ≠îÈóÆÈ¢òÂêéÂ∞ÜÊòæÁ§∫ËØ•‰πêÂô®ÁöÑÁâπÁÇπ‰ªãÁªçÂì¶ÔΩû</p>
            </div>
            
            <div class="feedback-area" id="feedbackArea"></div>
            
            <div class="result-area hidden" id="resultArea">
                <h2 class="result-title" id="resultTitle">Â§™Ê£íÂï¶ÔºÅüéâ</h2>
                <p class="result-score" id="resultScore">‰Ω†Âæó‰∫Ü 0 ÂàÜÔºåÊòØÈü≥‰πêÂ∞èËææ‰∫∫ÔΩû</p>
                <button class="restart-btn" id="restartBtn">ÈáçÊñ∞ÂºÄÂßã üîÑ</button>
            </div>
        </div>
    </div>

    <script>
        // 1. Ê∏∏ÊàèÊ†∏ÂøÉÊï∞ÊçÆÂÆö‰πâ
       const instrumentLibrary = {
	Èí¢Áê¥: {
	    name: "Èí¢Áê¥",
	    audioUrl: "https://for-teach52.github.io/raolaoshi-music-game1/piano.mp3",
	    desc: "Èí¢Áê¥ÊòØË•øÊ¥ãÂè§ÂÖ∏Èü≥‰πê‰∏≠ÁöÑ‰∏ÄÁßçÈîÆÁõò‰πêÂô®ÔºåÊúâ‚Äú‰πêÂô®‰πãÁéã‚ÄùÁöÑÁæéÁß∞„ÄÇÁî±88‰∏™Áê¥ÈîÆÔºà52‰∏™ÁôΩÈîÆÔºå36‰∏™ÈªëÈîÆÔºâÂíåÈáëÂ±ûÂº¶Èü≥ÊùøÁªÑÊàêÔºåÈü≥ÂüüÂÆΩÂπøÔºåË°®Áé∞Âäõ‰∏∞ÂØåÔºåÊó¢ËÉΩÁã¨Â•è‰πüËÉΩ‰º¥Â•è„ÄÇ"
	},
	Â∞èÊèêÁê¥: {
	    name: "Â∞èÊèêÁê¥",
	    audioUrl: "https://for-teach52.github.io/raolaoshi-music-game1/violin.mp3",
	    desc: "Â∞èÊèêÁê¥ÊòØ‰∏ÄÁßçÂº¶‰πêÂô®ÔºåÊúâ‚Äú‰πêÂô®ÁöáÂêé‚Äù‰πãÁß∞„ÄÇÁî±Áê¥Â§¥„ÄÅÁê¥È¢à„ÄÅÁê¥Ë∫´‰∏âÈÉ®ÂàÜÁªÑÊàêÔºåÈù†Áê¥ÂºìÊë©Êì¶Áê¥Âº¶ÂèëÂ£∞ÔºåÈü≥Ëâ≤‰ºòÁæéÔºåË°®Áé∞ÂäõÂº∫ÔºåÊòØÁÆ°Âº¶‰πêÈòü‰∏≠ÁöÑÊ†∏ÂøÉ‰πêÂô®„ÄÇ"
	},
	Êû∂Â≠êÈºì: {
	    name: "Êû∂Â≠êÈºì",
	    audioUrl: "https://for-teach52.github.io/raolaoshi-music-game1/drums.mp3",
	    desc: "Êû∂Â≠êÈºìÊòØÁàµÂ£´‰πêÈòü‰∏≠ÈáçË¶ÅÁöÑÊâìÂáª‰πêÂô®ÔºåÁî±Â§ö‰∏™ÈºìÂíåÈï≤ÁâáÁªÑÊàê„ÄÇÊ≤°ÊúâÂõ∫ÂÆöÁöÑÈü≥È´òÔºå‰∏ªË¶ÅÁî®‰∫éÊéßÂà∂ËäÇÂ•èÂíåÂæãÂä®ÔºåÊòØÁé∞‰ª£Èü≥‰πê‰∏≠‰∏çÂèØÊàñÁº∫ÁöÑËäÇÂ•è‰πêÂô®„ÄÇ"
	},
	ÈïøÁ¨õ: {
	    name: "ÈïøÁ¨õ",
	    audioUrl: "https://for-teach52.github.io/raolaoshi-music-game1/flute.mp3",
	    desc: "ÈïøÁ¨õÊòØÁé∞‰ª£ÁÆ°Âº¶‰πêÂíåÂÆ§‰πê‰∏≠‰∏ªË¶ÅÁöÑÈ´òÈü≥ÊóãÂæã‰πêÂô®ÔºåÂ±û‰∫éÊú®ÁÆ°‰πêÂô®„ÄÇÈü≥Ëâ≤Ê∏ÖÊñ∞„ÄÅÈÄèÂΩªÔºåÈü≥ÂüüÂÆΩÂπøÔºåÊó¢ËÉΩÊºîÂ•èÊäíÊÉÖÊóãÂæãÔºå‰πüËÉΩÊºîÂ•èÂø´ÈÄüÁöÑÈü≥Èò∂ÂíåË£ÖÈ•∞Èü≥„ÄÇ"
	},
	Âêâ‰ªñ: {
	    name: "Âêâ‰ªñ",
	    audioUrl: "https://for-teach52.github.io/raolaoshi-music-game1/guitar.mp3",
	    desc: "Âêâ‰ªñÂèàËØëÂÖ≠Âº¶Áê¥ÔºåÂ±û‰∫éÂºπÊã®‰πêÂô®„ÄÇÈÄöÂ∏∏ÊúâÂÖ≠Êù°Âº¶ÔºåÂΩ¢Áä∂‰∏éÊèêÁê¥Áõ∏‰ººÔºåÈü≥Ëâ≤ÂúÜÊ∂¶Ê∏©ÊöñÔºåÈÄÇÂêàÊ∞ëË∞£„ÄÅÊëáÊªö„ÄÅÂè§ÂÖ∏Á≠âÂ§öÁßçÈü≥‰πêÈ£éÊ†ºÔºåÊòØÈùûÂ∏∏ÊµÅË°åÁöÑÊ∞ëÈó¥‰πêÂô®„ÄÇ"
	},
	Âè§Á≠ù: {
	    name: "Âè§Á≠ù",
	    audioUrl: "https://for-teach52.github.io/raolaoshi-music-game1/guzheng.mp3",
	    desc: "Âè§Á≠ùÊòØ‰∏≠ÂõΩ‰º†ÁªüÂºπÊã®Âº¶È∏£‰πêÂô®ÔºåÂèàÂêçÊ±âÁ≠ù„ÄÅÁß¶Á≠ù„ÄÇ‰∏ÄËà¨Áî±‰∫åÂçÅ‰∏ÄÂº¶ÁªÑÊàêÔºåÈü≥Ëâ≤Ê∏ÖËÑÜÊÇ¶ËÄ≥ÔºåÊÇ†Êâ¨Âä®Âê¨ÔºåÊòØ‰∏≠ÂõΩÊ∞ëÊóè‰πêÂô®‰∏≠ÊûÅÂÖ∑‰ª£Ë°®ÊÄßÁöÑ‰πêÂô®‰πã‰∏Ä„ÄÇ"
	},
	Âî¢Âëê: {
	    name: "Âî¢Âëê",
	    audioUrl: "https://for-teach52.github.io/raolaoshi-music-game1/suona.mp3",
	    desc: "Âî¢ÂëêÊòØ‰∏≠ÂõΩÊ∞ëÊóèÂêπÁÆ°‰πêÂô®ÁöÑ‰∏ÄÁßçÔºåÈü≥Ëâ≤È´ò‰∫¢„ÄÅÂòπ‰∫ÆÔºåÁ©øÈÄèÂäõÊûÅÂº∫ÔºåÂ∏∏Áî®‰∫éÊ∞ëÈó¥Â©ö‰∏ßÂ´ÅÂ®∂„ÄÅËäÇÂ∫ÜÂÖ∏Á§ºÁ≠âÂú∫ÂêàÔºåÊòØÊûÅÂÖ∑ÁâπËâ≤ÁöÑÊ∞ëÈó¥‰πêÂô®„ÄÇ"
	},
  	Âè£È£éÁê¥: {
	    name: "Âè£È£éÁê¥",
	    audioUrl: "https://for-teach52.github.io/raolaoshi-music-game1/harmonica.mp3",
	    desc: "Âè£È£éÁê¥ÊòØ‰∏ÄÁßçÁªìÂêà‰∫ÜÈîÆÁõòÂíåÂêπÂ•èÁöÑ‰πêÂô®Ôºå‰ΩìÁßØÂ∞èÂ∑ß„ÄÅÈü≥Ëâ≤Êòé‰∫ÆÔºåÊìç‰ΩúÁÆÄÂçïÔºåÈùûÂ∏∏ÈÄÇÂêàÂÑøÁ´•Èü≥‰πêÂêØËíôÔºåÊó¢ËÉΩÁã¨Â•è‰πüËÉΩÂêàÂ•è„ÄÇ"
	},
  	Ëê®ÂÖãÊñØ: {
	    name: "Ëê®ÂÖãÊñØ",
	    audioUrl: "https://for-teach52.github.io/raolaoshi-music-game1/saxphone.mp3",
	    desc: "Ëê®ÂÖãÊñØÊòØ‰∏ÄÁßçÊú®ÁÆ°‰πêÂô®ÔºåÂÖºÂÖ∑ÈìúÁÆ°‰πêÂô®ÁöÑÂòπ‰∫ÆÂíåÊú®ÁÆ°‰πêÂô®ÁöÑÊüîÂíåÔºåÈü≥Ëâ≤‰∏∞ÂØåÂ§öÂèòÔºåÂπøÊ≥õÂ∫îÁî®‰∫éÁàµÂ£´„ÄÅÊµÅË°å„ÄÅÂè§ÂÖ∏Á≠âÈü≥‰πêÈ£éÊ†º„ÄÇ"
	},
  	Ëë´Ëä¶‰∏ù: {
	    name: "Ëë´Ëä¶‰∏ù",
	    audioUrl: "https://for-teach52.github.io/raolaoshi-music-game1/hulusi.mp3",
	    desc: "Ëë´Ëä¶‰∏ùÂèàÁß∞‚ÄúËë´Ëä¶ÁÆ´‚ÄùÔºåÊòØ‰∏≠ÂõΩ‰∫ëÂçóÂ∞ëÊï∞Ê∞ëÊóèÁâπËâ≤‰πêÂô®ÔºåÈü≥Ëâ≤ËΩªÊüîÁªÜËÖª„ÄÅÂúÜÊ∂¶Ë¥®Êú¥ÔºåÊìÖÈïøÊºîÂ•èÊäíÊÉÖÁöÑÊ∞ëÈó¥Êõ≤Ë∞É„ÄÇ"
	    }
	};

        // Ê∏∏ÊàèÁä∂ÊÄÅÂèòÈáè
        let currentScore = 0;
        let currentQuestionNum = 1;
        let totalQuestions = 10;
        let currentInstrument = null;
        let isAnswered = false;
        let audioPlayer = new Audio();
        let usedInstruments = [];
        // Êñ∞Â¢ûÔºöÁºìÂ≠òÈ¢ÑÂä†ËΩΩÁöÑÈü≥È¢ëÂØπË±°ÔºàÈÅøÂÖçÈáçÂ§çÂàõÂª∫Ôºâ
        let audioCache = {};

        // 2. DOMÂÖÉÁ¥†Ëé∑Âèñ
        const startBtn = document.getElementById('startBtn');
        const gameMain = document.getElementById('gameMain');
        const scoreElement = document.getElementById('score');
        const currentQuestionElement = document.getElementById('currentQuestion');
        const audioBtn = document.getElementById('audioBtn');
        const optionsArea = document.getElementById('optionsArea');
        const instrumentTitle = document.getElementById('instrumentTitle');
        const instrumentDesc = document.getElementById('instrumentDesc');
        const feedbackArea = document.getElementById('feedbackArea');
        const resultArea = document.getElementById('resultArea');
        const resultTitle = document.getElementById('resultTitle');
        const resultScore = document.getElementById('resultScore');
        const restartBtn = document.getElementById('restartBtn');

        // 3. Â∑•ÂÖ∑ÂáΩÊï∞
        // ÈöèÊú∫Ëé∑Âèñ‰∏Ä‰∏™‰πêÂô®ÔºàÁ°Æ‰øù‰∏çÈáçÂ§çÔºâ
        function getRandomInstrument() {
    	const instrumentNames = Object.keys(instrumentLibrary);
    	const availableInstruments = instrumentNames.filter(name => !usedInstruments.includes(name));
    	const randomIndex = Math.floor(Math.random() * availableInstruments.length);
    	const selectedName = availableInstruments[randomIndex];
    	usedInstruments.push(selectedName);
    	return instrumentLibrary[selectedName];
        }

        // ÁîüÊàêÈÄâÈ°π
        function generateOptions(correctInstrument) {
            const allInstruments = Object.values(instrumentLibrary);
            const wrongOptions = allInstruments
                .filter(instr => instr.name !== correctInstrument.name)
                .sort(() => 0.5 - Math.random())
                .slice(0, 3);
            const allOptions = [correctInstrument, ...wrongOptions].sort(() => 0.5 - Math.random());
            return allOptions;
        }

        // Ê∏≤ÊüìÈ¢òÁõÆ
        function renderQuestion() {
            isAnswered = false;
            feedbackArea.innerHTML = '';
            instrumentTitle.textContent = '‰πêÂô®Â∞èÁü•ËØÜ';
            instrumentDesc.textContent = 'ÂõûÁ≠îÈóÆÈ¢òÂêéÂ∞ÜÊòæÁ§∫ËØ•‰πêÂô®ÁöÑÁâπÁÇπ‰ªãÁªçÂì¶ÔΩû';
            
            currentInstrument = getRandomInstrument();
            const options = generateOptions(currentInstrument);
            
            optionsArea.innerHTML = '';
            options.forEach(option => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = option.name;
                btn.dataset.instrument = option.name;
                btn.addEventListener('click', handleOptionClick);
                optionsArea.appendChild(btn);
            });

            currentQuestionElement.textContent = currentQuestionNum;
        }

        // ‰øÆÂ§çÂêéÁöÑÊí≠ÊîæÈü≥È¢ëÂáΩÊï∞ÔºàÊ†∏ÂøÉ‰øÆÊîπÔºâ
        function playAudio() {
            if (!currentInstrument) return;
            
            // 1. ÊöÇÂÅú‰∏ä‰∏ÄÊÆµÊ≠£Âú®Êí≠ÊîæÁöÑÈü≥È¢ë
            audioPlayer.pause();
            // 2. ‰ºòÂÖà‰ΩøÁî®ÁºìÂ≠òÁöÑÈü≥È¢ëÂØπË±°ÔºåÈÅøÂÖçÈáçÂ§çÂä†ËΩΩ
            const audioUrl = currentInstrument.audioUrl;
            if (audioCache[audioUrl]) {
                audioPlayer = audioCache[audioUrl];
            } else {
                audioPlayer = new Audio(audioUrl);
                audioPlayer.crossOrigin = "anonymous";
                audioCache[audioUrl] = audioPlayer; // Â≠òÂÖ•ÁºìÂ≠ò
            }
            
            // 3. ÈáçÊñ∞Âä†ËΩΩÂπ∂Êí≠ÊîæÔºàËß£ÂÜ≥ÁºìÂ≠ò/Ë∑®ÂüüÂØºËá¥ÁöÑÊí≠ÊîæÂ§±Ë¥•Ôºâ
            audioPlayer.currentTime = 0; // ÈáçÁΩÆÊí≠Êîæ‰ΩçÁΩÆ
            audioPlayer.load(); // ÈáçÊñ∞Âä†ËΩΩÈü≥È¢ë
            audioPlayer.play().catch(err => {
                // ‰ºòÂåñÈîôËØØÊèêÁ§∫ÔºöÊòæÁ§∫ÂÖ∑‰Ωì‰πêÂô®ÂêçÁß∞ÔºåÊñπ‰æøÊéíÊü•
                alert(`„Äê${currentInstrument.name}„ÄëÈü≥È¢ëÊí≠ÊîæÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•Ôºö1.ÁΩëÁªúÊòØÂê¶Ê≠£Â∏∏ 2.ËØ•‰πêÂô®Èü≥È¢ëÊñá‰ª∂ÊòØÂê¶Â≠òÂú®`);
                console.error(`Èü≥È¢ëÊí≠ÊîæÈîôËØØÔºà${currentInstrument.name}Ôºâ:`, err);
            });
        }

        // Â§ÑÁêÜÈÄâÈ°πÁÇπÂáª
        function handleOptionClick(e) {
            if (isAnswered) return;
            isAnswered = true;

            const selectedBtn = e.target;
            const selectedName = selectedBtn.dataset.instrument;
            const isCorrect = selectedName === currentInstrument.name;

            const allOptionBtns = document.querySelectorAll('.option-btn');
            allOptionBtns.forEach(btn => {
                btn.disabled = true;
                if (btn.dataset.instrument === currentInstrument.name) {
                    btn.classList.add('correct');
                } else if (btn === selectedBtn && !isCorrect) {
                    btn.classList.add('wrong');
                }
            });

            const feedbackText = document.createElement('div');
            feedbackText.className = `feedback-text ${isCorrect ? 'feedback-correct' : 'feedback-wrong'}`;
            feedbackText.textContent = isCorrect ? '‚úÖ ÂõûÁ≠îÊ≠£Á°ÆÔºÅ' : `‚ùå ÂõûÁ≠îÈîôËØØÔºåÊ≠£Á°ÆÁ≠îÊ°àÊòØÔºö${currentInstrument.name}`;
            feedbackArea.appendChild(feedbackText);

            instrumentTitle.textContent = `${currentInstrument.name} üéµ`;
            instrumentDesc.textContent = currentInstrument.desc;

            if (isCorrect) {
                currentScore += 10;
                scoreElement.textContent = currentScore;
            }

            setTimeout(() => {
                if (currentQuestionNum < totalQuestions) {
                    currentQuestionNum++;
                    renderQuestion();
                } else {
                    showResult();
                }
            }, 2000);
        }

        // ÊòæÁ§∫Ê∏∏ÊàèÁªìÊûú
        function showResult() {
            resultArea.classList.remove('hidden');
            if (currentScore === 100) {
                resultTitle.textContent = 'Êª°ÂàÜÔºÅüéñÔ∏è Èü≥‰πêÂ∞èÂ§©ÊâçÔºÅ';
                resultScore.textContent = `‰Ω†Âæó‰∫Ü ${currentScore} ÂàÜÔºåÂ§™ÂéâÂÆ≥Âï¶ÔºÅ`;
            } else if (currentScore >= 70) {
                resultTitle.textContent = 'Ë∂ÖÊ£íÔºÅüéâ';
                resultScore.textContent = `‰Ω†Âæó‰∫Ü ${currentScore} ÂàÜÔºåÊòØÈü≥‰πêÂ∞èËææ‰∫∫ÔΩû`;
            } else if (currentScore >= 40) {
                resultTitle.textContent = '‰∏çÈîôÂì¶ÔºÅüí™';
                resultScore.textContent = `‰Ω†Âæó‰∫Ü ${currentScore} ÂàÜÔºåÁªßÁª≠Âä†Ê≤πÔºÅ`;
            } else {
                resultTitle.textContent = 'ÁªßÁª≠Âä™ÂäõÔºÅüåü';
                resultScore.textContent = `‰Ω†Âæó‰∫Ü ${currentScore} ÂàÜÔºåÂ§öÂê¨Âê¨‰πêÂô®Â£∞Èü≥Â∞±‰ºöÊõ¥Ê£íÂï¶ÔΩû`;
            }
        }

        // ÈáçÁΩÆÊ∏∏Êàè
        function resetGame() {
            currentScore = 0;
            currentQuestionNum = 1;
            usedInstruments = [];
            scoreElement.textContent = 0;
            resultArea.classList.add('hidden');
            renderQuestion();
        }

        // 4. ‰∫ã‰ª∂ÁõëÂê¨
        startBtn.addEventListener('click', () => {
            startBtn.classList.add('hidden');
            gameMain.classList.remove('hidden');
            resetGame();
        });

        audioBtn.addEventListener('click', playAudio);
        restartBtn.addEventListener('click', resetGame);

        // 5. ‰ºòÂåñÈ¢ÑÂä†ËΩΩÈÄªËæëÔºàÊèêÂâçÁºìÂ≠òÊâÄÊúâÈü≥È¢ëÔºâ
        document.addEventListener('DOMContentLoaded', () => {
            audioPlayer.volume = 0.7;
            // È¢ÑÂä†ËΩΩÊâÄÊúâÈü≥È¢ëÂπ∂Â≠òÂÖ•ÁºìÂ≠ò
            Object.values(instrumentLibrary).forEach(instr => {
                const audio = new Audio(instr.audioUrl);
                audio.crossOrigin = "anonymous";
                audio.load();
                audioCache[instr.audioUrl] = audio;
            });
        });
    </script>
</body>
</html>